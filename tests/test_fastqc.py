import unittest
import os
from os import path
from mytardis_ngs_ingestor.illumina import fastqc


class FastqcParserTestCase(unittest.TestCase):
    def setUp(self):
        data_dir = path.join(path.dirname(__file__), 'test_data')
        self.empty_fastq_file = path.join(data_dir, 'empty.fastq.gz')
        self.non_empty_fastq_file = path.join(
            data_dir,
            'runs/'
            '130907_DMO177_0001_AH9PJLADXZ/'
            '130907_DMO177_0001_AH9PJLADXZ.bcl2fastq/'
            'Undetermined_indices/'
            'Sample_lane1/'
            'lane1_Undetermined_L001_R1_001.fastq.gz')
        self.fastqc_zip = path.join(data_dir,
                                    'fastqc/Q1N_S7_L004_R1_001_fastqc.zip')

        self.qc_summary = [
            (u'PASS', u'Basic Statistics', u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'PASS', u'Per base sequence quality',
                u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'WARN', u'Per sequence quality scores',
                u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'PASS', u'Per base sequence content',
                u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'FAIL', u'Per sequence GC content',
                u'Q1N_S7_L004_R1_001.fastq.gz'),
            (u'PASS', u'Per base N content', u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'PASS', u'Sequence Length Distribution',
                u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'PASS', u'Sequence Duplication Levels',
                u'Q1N_S7_L004_R1_001.fastq.gz'), (
                u'PASS', u'Overrepresented sequences',
                u'Q1N_S7_L004_R1_001.fastq.gz'),
            (u'PASS', u'Adapter Content', u'Q1N_S7_L004_R1_001.fastq.gz'),
            (u'PASS', u'Kmer Content', u'Q1N_S7_L004_R1_001.fastq.gz')]

        self.parsed_data_txt = {u'Per base sequence quality':
                                    {'column_labels':
                                         (u'Base',
                                          u'Mean',
                                          u'Median',
                                          u'Lower Quartile',
                                          u'Upper Quartile',
                                          u'10th Percentile',
                                          u'90th Percentile'),
                                     'rows': [
                                         (u'1',
                                          u'24.5995',
                                          u'26.0',
                                          u'25.0',
                                          u'29.0',
                                          u'14.0',
                                          u'29.0'),
                                         (u'2',
                                          u'24.5685',
                                          u'26.0',
                                          u'25.0',
                                          u'29.0',
                                          u'14.0',
                                          u'29.0'),
                                         (u'3',
                                          u'24.8875',
                                          u'27.0',
                                          u'24.0',
                                          u'29.0',
                                          u'13.0',
                                          u'31.0'),
                                         (u'4',
                                          u'24.9805',
                                          u'28.0',
                                          u'25.0',
                                          u'29.0',
                                          u'13.0',
                                          u'29.0'),
                                         (u'5',
                                          u'24.621',
                                          u'28.0',
                                          u'23.0',
                                          u'29.0',
                                          u'11.0',
                                          u'30.0'),
                                         (u'6',
                                          u'25.108',
                                          u'29.0',
                                          u'22.0',
                                          u'30.0',
                                          u'12.0',
                                          u'31.0'),
                                         (u'7',
                                          u'25.3645',
                                          u'28.0',
                                          u'23.0',
                                          u'31.0',
                                          u'13.0',
                                          u'31.0'),
                                         (u'8',
                                          u'25.3265',
                                          u'29.0',
                                          u'24.0',
                                          u'30.0',
                                          u'11.0',
                                          u'30.0'),
                                         (u'9',
                                          u'25.528',
                                          u'29.0',
                                          u'24.0',
                                          u'30.0',
                                          u'12.0',
                                          u'31.0'),
                                         (u'10',
                                          u'25.5775',
                                          u'29.0',
                                          u'24.0',
                                          u'30.0',
                                          u'14.0',
                                          u'30.0'),
                                         (u'11',
                                          u'25.449',
                                          u'29.0',
                                          u'24.0',
                                          u'29.0',
                                          u'13.0',
                                          u'31.0'),
                                         (u'12',
                                          u'24.906',
                                          u'28.0',
                                          u'23.0',
                                          u'30.0',
                                          u'11.0',
                                          u'30.0'),
                                         (u'13',
                                          u'25.8925',
                                          u'29.0',
                                          u'25.0',
                                          u'30.0',
                                          u'13.0',
                                          u'31.0'),
                                         (u'14',
                                          u'26.359',
                                          u'29.0',
                                          u'25.0',
                                          u'31.0',
                                          u'13.0',
                                          u'33.0'),
                                         (u'15',
                                          u'26.1815',
                                          u'30.0',
                                          u'24.0',
                                          u'31.0',
                                          u'13.0',
                                          u'31.0'),
                                         (u'16',
                                          u'26.4655',
                                          u'29.0',
                                          u'25.0',
                                          u'32.0',
                                          u'14.0',
                                          u'32.0'),
                                         (u'17',
                                          u'26.0615',
                                          u'30.0',
                                          u'23.0',
                                          u'31.0',
                                          u'12.0',
                                          u'32.0'),
                                         (u'18',
                                          u'26.5',
                                          u'30.0',
                                          u'24.0',
                                          u'31.0',
                                          u'13.0',
                                          u'32.0'),
                                         (u'19',
                                          u'26.135',
                                          u'30.0',
                                          u'23.0',
                                          u'31.0',
                                          u'10.0',
                                          u'32.0'),
                                         (u'20',
                                          u'26.282',
                                          u'30.0',
                                          u'24.0',
                                          u'31.0',
                                          u'12.0',
                                          u'32.0'),
                                         (u'21',
                                          u'26.1355',
                                          u'30.0',
                                          u'22.0',
                                          u'32.0',
                                          u'12.0',
                                          u'32.0'),
                                         (u'22',
                                          u'27.2035',
                                          u'31.0',
                                          u'25.0',
                                          u'32.0',
                                          u'12.0',
                                          u'33.0'),
                                         (u'23',
                                          u'25.9385',
                                          u'29.0',
                                          u'23.0',
                                          u'31.0',
                                          u'12.0',
                                          u'32.0'),
                                         (u'24',
                                          u'26.132',
                                          u'30.0',
                                          u'22.0',
                                          u'31.0',
                                          u'13.0',
                                          u'33.0'),
                                         (u'25',
                                          u'26.192',
                                          u'30.0',
                                          u'23.0',
                                          u'31.0',
                                          u'11.0',
                                          u'34.0'),
                                         (u'26',
                                          u'26.131',
                                          u'30.0',
                                          u'23.0',
                                          u'31.0',
                                          u'13.0',
                                          u'32.0'),
                                         (u'27',
                                          u'26.235',
                                          u'30.0',
                                          u'23.0',
                                          u'32.0',
                                          u'13.0',
                                          u'32.0'),
                                         (u'28',
                                          u'25.8025',
                                          u'30.0',
                                          u'22.0',
                                          u'32.0',
                                          u'10.0',
                                          u'34.0'),
                                         (u'29',
                                          u'25.6975',
                                          u'30.0',
                                          u'22.0',
                                          u'31.0',
                                          u'10.0',
                                          u'33.0'),
                                         (u'30',
                                          u'25.1035',
                                          u'29.0',
                                          u'20.0',
                                          u'32.0',
                                          u'10.0',
                                          u'33.0'),
                                         (u'31',
                                          u'25.4085',
                                          u'29.0',
                                          u'21.0',
                                          u'32.0',
                                          u'9.0',
                                          u'34.0'),
                                         (u'32',
                                          u'25.3815',
                                          u'31.0',
                                          u'21.0',
                                          u'31.0',
                                          u'10.0',
                                          u'32.0'),
                                         (u'33',
                                          u'25.4815',
                                          u'30.0',
                                          u'21.0',
                                          u'32.0',
                                          u'10.0',
                                          u'33.0'),
                                         (u'34',
                                          u'25.0755',
                                          u'30.0',
                                          u'20.0',
                                          u'31.0',
                                          u'10.0',
                                          u'34.0'),
                                         (u'35',
                                          u'25.586',
                                          u'29.0',
                                          u'21.0',
                                          u'32.0',
                                          u'11.0',
                                          u'33.0'),
                                         (u'36',
                                          u'25.2345',
                                          u'30.0',
                                          u'21.0',
                                          u'32.0',
                                          u'10.0',
                                          u'33.0'),
                                         (u'37',
                                          u'25.0425',
                                          u'29.0',
                                          u'20.0',
                                          u'32.0',
                                          u'8.0',
                                          u'34.0'),
                                         (u'38',
                                          u'25.15',
                                          u'29.0',
                                          u'21.0',
                                          u'32.0',
                                          u'9.0',
                                          u'33.0'),
                                         (u'39',
                                          u'24.594',
                                          u'29.0',
                                          u'20.0',
                                          u'32.0',
                                          u'8.0',
                                          u'33.0'),
                                         (u'40',
                                          u'24.873',
                                          u'28.0',
                                          u'20.0',
                                          u'31.0',
                                          u'9.0',
                                          u'34.0'),
                                         (u'41',
                                          u'24.86',
                                          u'29.0',
                                          u'19.0',
                                          u'32.0',
                                          u'8.0',
                                          u'34.0'),
                                         (u'42',
                                          u'24.313',
                                          u'28.0',
                                          u'18.0',
                                          u'31.0',
                                          u'8.0',
                                          u'34.0'),
                                         (u'43',
                                          u'24.3255',
                                          u'26.0',
                                          u'18.0',
                                          u'32.0',
                                          u'8.0',
                                          u'34.0'),
                                         (u'44',
                                          u'24.1065',
                                          u'27.0',
                                          u'18.0',
                                          u'31.0',
                                          u'8.0',
                                          u'34.0'),
                                         (u'45',
                                          u'23.9155',
                                          u'27.0',
                                          u'19.0',
                                          u'31.0',
                                          u'8.0',
                                          u'33.0'),
                                         (u'46',
                                          u'23.6685',
                                          u'27.0',
                                          u'18.0',
                                          u'31.0',
                                          u'8.0',
                                          u'32.0'),
                                         (u'47',
                                          u'23.884',
                                          u'26.0',
                                          u'17.0',
                                          u'31.0',
                                          u'9.0',
                                          u'34.0'),
                                         (u'48',
                                          u'23.268',
                                          u'26.0',
                                          u'17.0',
                                          u'31.0',
                                          u'8.0',
                                          u'33.0'),
                                         (u'49',
                                          u'23.7525',
                                          u'27.0',
                                          u'18.0',
                                          u'30.0',
                                          u'9.0',
                                          u'32.0'),
                                         (u'50',
                                          u'23.549',
                                          u'27.0',
                                          u'18.0',
                                          u'31.0',
                                          u'7.0',
                                          u'34.0'),
                                         (u'51',
                                          u'22.911',
                                          u'26.0',
                                          u'16.0',
                                          u'30.0',
                                          u'7.0',
                                          u'33.0')],
                                     'qc_result': u'pass'},
                                u'Sequence Duplication Levels': {
                                    'column_labels': (
                                        u'Duplication Level',
                                        u'Percentage of deduplicated',
                                        u'Percentage of total'), 'rows': [
                                        (u'1', u'99.74937343358395', u'99.5'),
                                        (u'2', u'0.2506265664160401', u'0.5'),
                                        (u'3', u'0.0', u'0.0'),
                                        (u'4', u'0.0', u'0.0'),
                                        (u'5', u'0.0', u'0.0'),
                                        (u'6', u'0.0', u'0.0'),
                                        (u'7', u'0.0', u'0.0'),
                                        (u'8', u'0.0', u'0.0'),
                                        (u'9', u'0.0', u'0.0'),
                                        (u'>10', u'0.0', u'0.0'),
                                        (u'>50', u'0.0', u'0.0'),
                                        (u'>100', u'0.0', u'0.0'),
                                        (u'>500', u'0.0', u'0.0'),
                                        (u'>1k', u'0.0', u'0.0'),
                                        (u'>5k', u'0.0', u'0.0'),
                                        (u'>10k+', u'0.0', u'0.0')],
                                    'qc_result': u'pass'},
                                u'Kmer Content': {'rows': [],
                                                  'qc_result': u'pass'},
                                u'Per base sequence content': {
                                    'column_labels': (
                                        u'Base', u'G', u'A', u'T', u'C'),
                                    'rows': [(u'1',
                                              u'24.349999999999998',
                                              u'24.349999999999998',
                                              u'23.5',
                                              u'27.800000000000004'),
                                             (u'2',
                                              u'26.400000000000002',
                                              u'23.05',
                                              u'23.25',
                                              u'27.3'),
                                             (u'3',
                                              u'25.650000000000002',
                                              u'24.5',
                                              u'23.7',
                                              u'26.150000000000002'),
                                             (u'4',
                                              u'24.95',
                                              u'22.45',
                                              u'25.25',
                                              u'27.35'),
                                             (u'5',
                                              u'25.8',
                                              u'23.3',
                                              u'24.15',
                                              u'26.75'),
                                             (u'6',
                                              u'26.650000000000002',
                                              u'25.1',
                                              u'21.8',
                                              u'26.450000000000003'),
                                             (u'7',
                                              u'25.4',
                                              u'24.2',
                                              u'22.400000000000002',
                                              u'28.000000000000004'),
                                             (u'8',
                                              u'23.849999999999998',
                                              u'25.6',
                                              u'24.05',
                                              u'26.5'),
                                             (u'9',
                                              u'24.099999999999998',
                                              u'24.65',
                                              u'24.8',
                                              u'26.450000000000003'),
                                             (
                                                 u'10',
                                                 u'25.85',
                                                 u'25.15',
                                                 u'22.650000000000002',
                                                 u'26.35'),
                                             (
                                                 u'11',
                                                 u'25.05',
                                                 u'24.349999999999998',
                                                 u'23.799999999999997',
                                                 u'26.8'),
                                             (
                                                 u'12',
                                                 u'25.95',
                                                 u'24.65',
                                                 u'23.0',
                                                 u'26.400000000000002'),
                                             (
                                                 u'13',
                                                 u'27.900000000000002',
                                                 u'25.25',
                                                 u'23.599999999999998',
                                                 u'23.25'),
                                             (
                                                 u'14',
                                                 u'28.299999999999997',
                                                 u'22.5',
                                                 u'24.5',
                                                 u'24.7'),
                                             (
                                                 u'15',
                                                 u'27.0',
                                                 u'25.15',
                                                 u'22.7',
                                                 u'25.15'),
                                             (
                                                 u'16',
                                                 u'25.8',
                                                 u'24.75',
                                                 u'24.3',
                                                 u'25.15'),
                                             (
                                                 u'17',
                                                 u'27.85',
                                                 u'23.45',
                                                 u'23.7',
                                                 u'25.0'),
                                             (
                                                 u'18',
                                                 u'26.25',
                                                 u'24.05',
                                                 u'25.1',
                                                 u'24.6'),
                                             (
                                                 u'19',
                                                 u'27.3',
                                                 u'24.75',
                                                 u'23.0',
                                                 u'24.95'),
                                             (
                                                 u'20',
                                                 u'25.5',
                                                 u'24.5',
                                                 u'23.0',
                                                 u'27.0'),
                                             (
                                                 u'21',
                                                 u'26.1',
                                                 u'23.9',
                                                 u'24.0',
                                                 u'26.0'),
                                             (
                                                 u'22',
                                                 u'26.150000000000002',
                                                 u'22.8',
                                                 u'26.0',
                                                 u'25.05'),
                                             (
                                                 u'23',
                                                 u'26.55',
                                                 u'23.0',
                                                 u'23.200000000000003',
                                                 u'27.250000000000004'),
                                             (
                                                 u'24',
                                                 u'23.65',
                                                 u'23.9',
                                                 u'25.75',
                                                 u'26.700000000000003'),
                                             (
                                                 u'25',
                                                 u'24.45',
                                                 u'24.65',
                                                 u'26.900000000000002',
                                                 u'24.0'),
                                             (
                                                 u'26',
                                                 u'26.200000000000003',
                                                 u'24.099999999999998',
                                                 u'24.45',
                                                 u'25.25'),
                                             (
                                                 u'27',
                                                 u'26.5',
                                                 u'22.0',
                                                 u'25.85',
                                                 u'25.650000000000002'),
                                             (
                                                 u'28',
                                                 u'26.6',
                                                 u'22.7',
                                                 u'24.349999999999998',
                                                 u'26.35'),
                                             (
                                                 u'29',
                                                 u'24.9',
                                                 u'24.75',
                                                 u'23.95',
                                                 u'26.400000000000002'),
                                             (
                                                 u'30',
                                                 u'23.25',
                                                 u'23.200000000000003',
                                                 u'26.1',
                                                 u'27.450000000000003'),
                                             (
                                                 u'31',
                                                 u'24.65',
                                                 u'23.549999999999997',
                                                 u'25.75',
                                                 u'26.05'),
                                             (
                                                 u'32',
                                                 u'24.55',
                                                 u'22.8',
                                                 u'26.150000000000002',
                                                 u'26.5'),
                                             (
                                                 u'33',
                                                 u'25.25',
                                                 u'24.45',
                                                 u'24.25',
                                                 u'26.05'),
                                             (
                                                 u'34',
                                                 u'26.05',
                                                 u'24.7',
                                                 u'22.6',
                                                 u'26.650000000000002'),
                                             (
                                                 u'35',
                                                 u'25.650000000000002',
                                                 u'24.85',
                                                 u'24.3',
                                                 u'25.2'),
                                             (
                                                 u'36',
                                                 u'25.15',
                                                 u'25.05',
                                                 u'23.65',
                                                 u'26.150000000000002'),
                                             (
                                                 u'37',
                                                 u'25.1',
                                                 u'25.05',
                                                 u'23.849999999999998',
                                                 u'26.0'),
                                             (
                                                 u'38',
                                                 u'23.7',
                                                 u'24.4',
                                                 u'24.15',
                                                 u'27.750000000000004'),
                                             (
                                                 u'39',
                                                 u'24.6',
                                                 u'25.15',
                                                 u'24.5',
                                                 u'25.75'),
                                             (
                                                 u'40',
                                                 u'24.2',
                                                 u'24.0',
                                                 u'26.5',
                                                 u'25.3'),
                                             (
                                                 u'41',
                                                 u'24.25',
                                                 u'25.650000000000002',
                                                 u'24.95',
                                                 u'25.15'),
                                             (
                                                 u'42',
                                                 u'24.55',
                                                 u'24.9',
                                                 u'24.75',
                                                 u'25.8'),
                                             (
                                                 u'43',
                                                 u'24.85',
                                                 u'23.75',
                                                 u'24.15',
                                                 u'27.250000000000004'),
                                             (
                                                 u'44',
                                                 u'25.35',
                                                 u'24.5',
                                                 u'23.799999999999997',
                                                 u'26.35'),
                                             (
                                                 u'45',
                                                 u'26.3',
                                                 u'25.45',
                                                 u'24.3',
                                                 u'23.95'),
                                             (
                                                 u'46',
                                                 u'26.25',
                                                 u'23.05',
                                                 u'24.3',
                                                 u'26.400000000000002'),
                                             (
                                                 u'47',
                                                 u'23.200000000000003',
                                                 u'24.099999999999998',
                                                 u'25.5',
                                                 u'27.200000000000003'),
                                             (
                                                 u'48',
                                                 u'26.55',
                                                 u'23.95',
                                                 u'24.45',
                                                 u'25.05'),
                                             (
                                                 u'49',
                                                 u'25.75',
                                                 u'24.0',
                                                 u'24.2',
                                                 u'26.05'),
                                             (
                                                 u'50',
                                                 u'27.900000000000002',
                                                 u'23.05',
                                                 u'24.0',
                                                 u'25.05'),
                                             (
                                                 u'51',
                                                 u'25.35',
                                                 u'24.25',
                                                 u'26.6',
                                                 u'23.799999999999997')],
                                    'qc_result': u'pass'},
                                u'Per sequence GC content': {
                                    'column_labels': (u'GC Content', u'Count'),
                                    'rows': [(u'0', u'0.0'), (u'1', u'0.0'),
                                             (u'2', u'0.0'),
                                             (u'3', u'0.0'), (u'4', u'0.0'),
                                             (u'5', u'0.0'),
                                             (u'6', u'0.0'), (u'7', u'0.0'),
                                             (u'8', u'0.0'),
                                             (u'9', u'0.0'), (u'10', u'0.0'),
                                             (u'11', u'0.5'),
                                             (u'12', u'1.0'), (u'13', u'1.0'),
                                             (u'14', u'1.0'),
                                             (u'15', u'1.0'), (u'16', u'1.0'),
                                             (u'17', u'1.0'),
                                             (u'18', u'1.0'), (u'19', u'3.0'),
                                             (u'20', u'5.0'),
                                             (u'21', u'5.5'), (u'22', u'6.0'),
                                             (u'23', u'9.5'),
                                             (u'24', u'13.0'), (u'25', u'12.5'),
                                             (u'26', u'13.5'),
                                             (u'27', u'15.0'), (u'28', u'15.5'),
                                             (u'29', u'16.0'),
                                             (u'30', u'21.5'), (u'31', u'27.0'),
                                             (u'32', u'30.0'),
                                             (u'33', u'33.0'), (u'34', u'38.0'),
                                             (u'35', u'43.0'),
                                             (u'36', u'45.0'), (u'37', u'47.0'),
                                             (u'38', u'55.5'),
                                             (u'39', u'64.0'), (u'40', u'73.5'),
                                             (u'41', u'83.0'),
                                             (u'42', u'88.5'), (u'43', u'94.0'),
                                             (u'44', u'104.0'),
                                             (u'45', u'114.0'),
                                             (u'46', u'106.0'),
                                             (u'47', u'98.0'),
                                             (u'48', u'120.5'),
                                             (u'49', u'143.0'),
                                             (u'50', u'126.5'),
                                             (u'51', u'110.0'),
                                             (u'52', u'119.0'),
                                             (u'53', u'128.0'),
                                             (u'54', u'137.5'),
                                             (u'55', u'147.0'),
                                             (u'56', u'156.0'),
                                             (u'57', u'165.0'),
                                             (u'58', u'165.0'),
                                             (u'59', u'165.0'),
                                             (u'60', u'164.5'),
                                             (u'61', u'164.0'),
                                             (u'62', u'143.0'),
                                             (u'63', u'122.0'),
                                             (u'64', u'98.0'), (u'65', u'74.0'),
                                             (u'66', u'62.0'), (u'67', u'50.0'),
                                             (u'68', u'39.5'),
                                             (u'69', u'29.0'), (u'70', u'22.5'),
                                             (u'71', u'16.0'),
                                             (u'72', u'13.0'), (u'73', u'10.0'),
                                             (u'74', u'6.0'),
                                             (u'75', u'1.0'), (u'76', u'0.0'),
                                             (u'77', u'0.5'),
                                             (u'78', u'1.0'), (u'79', u'0.5'),
                                             (u'80', u'0.0'),
                                             (u'81', u'0.0'), (u'82', u'0.0'),
                                             (u'83', u'0.0'),
                                             (u'84', u'0.0'), (u'85', u'0.0'),
                                             (u'86', u'0.0'),
                                             (u'87', u'0.0'), (u'88', u'0.0'),
                                             (u'89', u'0.0'),
                                             (u'90', u'0.0'), (u'91', u'0.0'),
                                             (u'92', u'0.0'),
                                             (u'93', u'0.0'), (u'94', u'0.0'),
                                             (u'95', u'0.0'),
                                             (u'96', u'0.0'), (u'97', u'0.0'),
                                             (u'98', u'0.0'),
                                             (u'99', u'0.0'), (u'100', u'0.0')],
                                    'qc_result': u'fail'},
                                u'Sequence Length Distribution': {
                                    'column_labels': (u'Length', u'Count'),
                                    'rows': [(u'51', u'2000.0')],
                                    'qc_result': u'pass'},
                                'fastqc_version': u'0.11.3',
                                u'Basic Statistics': {
                                    'column_labels': (u'Measure', u'Value'),
                                    'rows': [(u'Filename',
                                              u'Q1N_S7_L004_R1_001.fastq.gz'), (
                                                 u'File type',
                                                 u'Conventional base calls'),
                                             (u'Encoding',
                                              u'Sanger / Illumina 1.9'),
                                             (u'Total Sequences', u'2000'), (
                                                 u'Sequences flagged as poor quality',
                                                 u'0'),
                                             (u'Sequence length', u'51'),
                                             (u'%GC', u'51')],
                                    'qc_result': u'pass'},
                                u'Adapter Content': {'column_labels': (
                                    u'Position', u'Illumina Universal Adapter',
                                    u'Illumina Small RNA Adapter',
                                    u'Nextera Transposase Sequence',
                                    u'SOLID Small RNA Adapter'),
                                    'rows': [
                                        (u'1', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'2', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'3', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'4', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'5', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'6', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'7', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'8', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'9', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'10', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'11', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'12', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'13', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'14', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'15', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'16', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'17', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'18', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'19', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'20', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'21', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'22', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'23', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'24', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'25', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'26', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'27', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'28', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'29', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'30', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'31', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'32', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'33', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'34', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'35', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'36', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'37', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (u'38', u'0.0', u'0.0', u'0.0', u'0.0'),
                                        (
                                            u'39', u'0.0', u'0.0', u'0.0',
                                            u'0.0')],
                                    'qc_result': u'pass'},
                                u'Overrepresented sequences': {'rows': [],
                                                               'qc_result': u'pass'},
                                u'Per base N content': {
                                    'column_labels': (u'Base', u'N-Count'),
                                    'rows': [(u'1', u'0.0'), (u'2', u'0.0'),
                                             (u'3', u'0.0'), (u'4', u'0.0'),
                                             (u'5', u'0.0'), (u'6', u'0.0'),
                                             (u'7', u'0.0'), (u'8', u'0.0'),
                                             (u'9', u'0.0'), (u'10', u'0.0'),
                                             (u'11', u'0.0'), (u'12', u'0.0'),
                                             (u'13', u'0.0'), (u'14', u'0.0'),
                                             (u'15', u'0.0'), (u'16', u'0.0'),
                                             (u'17', u'0.0'), (u'18', u'0.0'),
                                             (u'19', u'0.0'), (u'20', u'0.0'),
                                             (u'21', u'0.0'), (u'22', u'0.0'),
                                             (u'23', u'0.0'), (u'24', u'0.0'),
                                             (u'25', u'0.0'), (u'26', u'0.0'),
                                             (u'27', u'0.0'), (u'28', u'0.0'),
                                             (u'29', u'0.0'), (u'30', u'0.0'),
                                             (u'31', u'0.0'), (u'32', u'0.0'),
                                             (u'33', u'0.0'), (u'34', u'0.0'),
                                             (u'35', u'0.0'), (u'36', u'0.0'),
                                             (u'37', u'0.0'), (u'38', u'0.0'),
                                             (u'39', u'0.0'), (u'40', u'0.0'),
                                             (u'41', u'0.0'), (u'42', u'0.0'),
                                             (u'43', u'0.0'), (u'44', u'0.0'),
                                             (u'45', u'0.0'), (u'46', u'0.0'),
                                             (u'47', u'0.0'), (u'48', u'0.0'),
                                             (u'49', u'0.0'), (u'50', u'0.0'),
                                             (u'51', u'0.0')],
                                    'qc_result': u'pass'},
                                u'Per sequence quality scores': {
                                    'column_labels': (u'Quality', u'Count'),
                                    'rows': [(u'20', u'1.0'), (u'21', u'10.0'),
                                             (u'22', u'41.0'),
                                             (u'23', u'237.0'),
                                             (u'24', u'538.0'),
                                             (u'25', u'687.0'),
                                             (u'26', u'373.0'),
                                             (u'27', u'103.0'),
                                             (u'28', u'10.0')],
                                    'qc_result': u'warn'}}

    def tearDown(self):
        pass

    def test_empty_fastq_detection(self):
        self.assertTrue(fastqc._fastq_is_empty(self.empty_fastq_file))
        self.assertFalse(fastqc._fastq_is_empty(self.non_empty_fastq_file))

    def test_fastqc_parse_summary_txt(self):
        expected = self.qc_summary

        result = fastqc.parse_summary_txt(self.fastqc_zip)

        self.assertListEqual(expected, result)

    def test_fastqc_parse_data_txt(self):
        expected = self.parsed_data_txt

        result = fastqc.parse_data_txt(self.fastqc_zip)

        self.assertDictEqual(expected, result)

    def test_fastqc_extract_basic_stats(self):
        expected = {'read_length': 51, 'number_of_reads': 2000,
                    'percent_gc': 51.0}

        result = fastqc.extract_basic_stats(
            {u'Q1N_S7_L004_R1_001': self.parsed_data_txt},
            u'Q1N_S7_L004_R1_001')

        self.assertDictEqual(expected, result)


if __name__ == '__main__':
    unittest.main()
